% **************************************************************************** %
\chapter{L\"osungsans\"atze und Simulationen}
\label{chap:simu}
% **************************************************************************** %

Bevor  simuliert  werden  kann,  m\"ussen  die  daf\"ur  ben\"otigten  Modelle
vorhanden sein. In diesem Abschnitt wird zuerst ein Modell f\"ur eine PV-Zelle
bestimmt und  anschliessend benutzt,  um ein  PV-Modul aufzubauen.   Es werden
verschiedene L\"osungsans\"atze  pr\"asentiert, mit den  entwickelten Modellen
simuliert und die Resultate beurteilt.


% ---------------------------------------------------------------------------- %
\section{Modellierung einer PV-Zelle}
\label{sec:simu:model:cell}
% ---------------------------------------------------------------------------- %

\begin{wrapfigure}{r}{65mm}
    \centering
    \input{images/circuits/solarCell-1d.tex}
    \caption{%
        Eindiodenmodell  einer  PV-Zelle  mit  Stromquelle  $I_{\mathrm{Ph}}$,
        Diode  $D$,  Shunt-Widerstand $R_{\mathrm{Sh}}$~  und  Seriewiderstand
        $R_{\mathrm{S}}$.%
    }
    \label{fig:pvcell:1diode}
\end{wrapfigure}

Das Modell  einer idealien  Photovoltaikzelle ist  eine Stromquelle  mit einer
parallel geschalteten Diode. Da PV-Zellen in Realit\"at nicht ideal sind, wird
das einfachste Ersatzschaltbild einer PV-Zelle \"ublicherweise durch einen zur
Stromquelle parallel geschalteten Shunt-Widerstand $R_{\mathrm{Sh}}$ und einen
Seriewiderstand $R_{\mathrm{S}}$ erg\"anzt; das resultierende Ersatzschaltbild
ist in Abbildung \ref{fig:pvcell:1diode} dargestellt.

Die Genauigkeit  dieses Eindiodenmodells  ist jedoch h\"aufig  nicht besonders
gut  \cite{pvcell:phang}  \cite{pvcell:masmoudi}   (besonders  bei  niederigen
Beleuchtungsgraden),   weshalb   wir   hier  ein   Zweidiodenmodell   benutzen
werden. Eine  der  beiden  Dioden   modelliert  dabei  den  S\"attigungsstrom,
welcher von  Diffusionsprozessen verursacht wird, die  zweite Diode modelliert
den  S\"attigungsstrom,  welcher  von Rekombinationseffekten  verursacht  wird
\cite{pvcell:masmoudi}.

Zur Herleitung der Modellparamater existieren verschiedene Verfahren. Man kann
beispielsweise eine  PV-Zelle im Labor  ausmessen und die  Modellparameter aus
diesen  Messergebnissen  ableiten.   Dies  ist jedoch  nicht  immer  praktisch
realisierbar, da man allenfalls kein Testexemplar zur Verf\"ugung hat.  Sollen
bei  der  Messung  noch Fertigungstoleranzen  der  PV-Zellen  ber\"ucksichtigt
werden,  steigt der  experimentelle  (und  finanzielle) Aufwand  zus\"atzlich,
da  man  mehrere Exemplare  kaufen  und  ausmessen muss. Auch  die  Auswertung
erfordert mehr Arbeit, wenn  man mittels statistischer Methoden verl\"assliche
Schlussfolgerungen ziehen k\"onnen will.

Alternativ   kann   man   auch   versuchen,  die   Modellparameter   aus   dem
Datenblatt  einer  PV-Zelle  herzuleiten. Dies  bietet  zwei  haupts\"achliche
Vorteile: Einerseits  entfallen  aufw\"andige  Messungen   und  der  Kauf  von
Testexemplaren, andererseits ist davon auszugehen, dass der Hersteller mehrere
Exemplare ausgemessen hat  und typische Angaben in  den Datenbl\"atten gemacht
werden.  Es setzt jedoch voraus,  dass man den Herstellerangaben einigermassen
vertraut;  Sicherheit  ist  letztendlich  nur  durch  eigene  Verifikation  zu
erlangen.

Das Herleiten der Modellparameter aus den Herstellerangaben ist nicht trivial;
es wird deshalb  an dieser Stelle ein Modell  einer kommerziell erh\"altlichen
PV-Zelle  \todo{Hersteller   nennen}  als  Grundlage  verwendet,   welches  in
\cite{pvcell:masmoudi} hergeleitet und verifiziert worden ist.

\"Ublicherweise wird  bei PV-Zellen  nur das  Gleichstromverhalten untersucht;
das Verhalten  unter Wechselstrom interessiert meistens  nicht. Da das Signal,
welches  in  diesem  Projekt  auf die  DC-Leitung  aufmoduliert  wird,  jedoch
Wechselstrom ist,  sollte das  Wechselstromverhalten von PV-Zellen  in unseren
Simulationen ber\"ucksichtigt werden.

Das  Zweidiodenmodell  aus  \cite{pvcell:masmoudi}  wird  deshalb  in  unseren
Simulationen   noch   durch    eine   parallele   Kapazit\"at   erg\"anzt. Die
Gr\"ossenordnung   dieser   Kapazit\"at   kann  stark   variieren   und   wird
unter    anderem   vom    Diodenmaterial,   der    Diodenspannung   und    der
Diodentemperatur   beeinflusst. Basierend    auf   \cite{capacitance:hegedus},
\cite{capacitance:mandal}     und      \cite{capacitance:mauk}     soll     an
dieser    Stelle   eine    fl\"achennormierte    Kapazit\"at    von   $C'    =
\SI{20}{\nano\farad\per\centi\meter\squared}$    verwendet   werden. Die    in
\cite{pvcell:masmoudi}    verwendete    Zelle    hat   eine    Gr\"osse    von
$\SI{125}{\milli\meter}    \times     \SI{125}{\milli\meter}$    (allf\"allige
abgeschnittene  Ecken, wie  sie in  Abbildung \ref{fig:pvcell:front}  zu sehen
sind,  werden  vernachl\"assigt),  womit  die  Kapazit\"at  einer  Zelle  sich
berechnet zu:

\begin{equation}
    \label{eq:capa:jac}
    C_{\mathrm{Zelle}}
    = A_{\mathrm{Zelle}} \cdot C'
    = \left( \SI{125}{\milli\meter} \right)^4 \cdot \SI{20}{\nano\farad\per\centi\meter\squared}
    = \SI{3.125}{\micro\farad}
\end{equation}

Somit  sind das  Ersatzschaltbild  und die  zugeh\"origen Parameter  bestimmt;
die  Ergebnisse  sind  in Abbildung  \ref{fig:circuit:solarCell}  und  Tabelle
\ref{tab:solarCell:params} abgebildet respektive aufgelistet.
\todo{referenz spice}

\begin{figure}[h!tb]
    \centering
    \input{images/circuits/solarCell.tex}
    \caption{%
        Schaltschema    zur    Modellierung    einer    Solarzelle    gem\"ass
        Zweidiodenmodell  mit  zus\"atzlicher  Kapazit\"at. Die  zugeh\"origen
        Modellparameter    sind    in    Tabelle    \ref{tab:solarCell:params}
        aufgelistet.%
    }
    \label{fig:circuit:solarCell}
\end{figure}

\begin{table}[h!t]
    \centering
    \caption{\"Ubersicht Modellparameter f\"ur Solarzelle aus Abbildung \ref{fig:circuit:solarCell}}
    \label{tab:solarCell:params}
    \begin{tabular}{llrp{20mm}}
        \toprule
        Parameter                              & Symbol                  & Wert                       & Quelle                 \\
        \midrule
        Diodenstrom (\emph{Photo Current})     & $I_{\mathrm{Ph}}$       & \SI{5.889}{\ampere}        & \cite{pvcell:masmoudi} \\
        S\"attigungsstrom Diffusionsdiode      & $I_{\mathrm{S,Diff}}$   & \SI{794.06}{\pico\ampere}  & \cite{pvcell:masmoudi} \\
        S\"attigungsstrom Rekombinationsdiode  & $I_{\mathrm{S,Rekomb}}$ & \SI{5.0762}{\micro\ampere} & \cite{pvcell:masmoudi} \\
        Idealit\"atsfaktor Diffusionsdiode     & $n_{\mathrm{Diff}}$     & \num{1}                    & \cite{pvcell:masmoudi} \\
        Idealit\"atsfaktor Rekombinationsdiode & $n_{\mathrm{Rekomb}}$   & \num{2}                    & \cite{pvcell:masmoudi} \\
        Seriewiderstand                        & $R_{\mathrm{S}}$        & \SI{1.71}{\milli\ohm}      & \cite{pvcell:masmoudi} \\
        Shunt-Widerstand                       & $R_{\mathrm{Sh}}$       & \SI{59.23}{\ohm}           & \cite{pvcell:masmoudi} \\
        Kapazit\"at                            & $C$                     & \SI{3.125}{\micro\farad}   & \cite{capacitance:hegedus}, \cite{capacitance:mandal}, \cite{capacitance:mauk}, Gl. \ref{eq:capa:jac} \\
        Kantenl\"ange                          & $s$                     & \SI{125}{\milli\meter}     & \cite{pvcell:masmoudi} \\
        \bottomrule
    \end{tabular}
\end{table}

% ---------------------------------------------------------------------------- %
\clearpage
\section{Modellierung eines PV-Moduls}
\label{sec:simu:model:module}
% ---------------------------------------------------------------------------- %


Das im obigen Abschnitt hergeleitete PV-Zellen-Modell wird nun dazu verwendet,
ein Modell f\"ur ein  PV-Modul aufzubauen. In Anhang \ref{app:models:calcs} ab
Seite  \pageref{app:models:calcs}  sind  als Anhaltspunkt  die  Daten  einiger
kommerzieller PV-Module mit verschiedenen Zellenkonfigurationen aufgelistet.

Es     wird    ein     PV-Modul     aus    72     in    Serie     angeordneten
Zellen    gew\"ahlt     und    implementiert. Es    wird     ebenfalls    eine
Freilaufdiode    parallel    zu     jedem    Modul    geschaltet,    basierend
auf     den     in    Abbildungen     \label{fig:simu:iv-curves:array:generic}
\label{fig:simu:iv-curves:array:generic:bypass}  gezeigten  Effekten  und  den
zugeh\"origen Anmerkungen.

\begin{wrapfigure}{l}{50mm}
    \centering
    \input{images/solar-facility/pvmodule-wiring.tex}
    \caption{
        Solarmodul  gem\"ass Abbildung  \ref{fig:pvmodule} mit  Stromleitungen
        und  L\"angen   zur  Verbindung   der  Zellen. Die   Nummerierung  der
        Leiterbahnen   entspricht    der   Nummerierung    der   Koeffizienten
        in   Gleichungen   \ref{eq:rosa:a1}    bis   \ref{eq:rosa:a3}   (Seite
        \pageref{eq:rosa:a1}).%
    }
    \label{fig:pvmodule:wiring}
    \vspace*{-3em}
\end{wrapfigure}

Der  Pfad, den  der Strom  in  einem Modul  zur\"ucklegt, kann  je nach  Modul
mehrere Meter L\"ange  erreichen.  Dieser Effekt wird in  unserem Modell durch
eine Stromleitung modelliert, die \"uber  alle Zellen geht. In Realit\"at sind
die Leiter, welche die Zellen miteinander verbinden, ziemlich kurz (angenommen
die Zellen werden  von Kante zu Kante verbunden), aber  da der Strompfad durch
die ganze Zelle geht, wird der gesamte Strompfad in underem Modell vereinfacht
als eine lange Leitung dargestellt.

Zwischen   diesen   parallelen    Leiterbahnen   ergeben   sich   parasit\"are
Induktivit\"aten, die  im Folgenden  bestimmt und  in unser  Modell integriert
werden.  Die  angenommene Form und  die Abmessungen der  internen Stromleitung
sind  in  Abbildung   \ref{fig:pvmodule:wiring}  dargestellt. Die  Abmessungen
basieren auf folgenden Annahmen:

\begin{itemize}
    \tightlist
    \item
        Kantenl\"ange eines Moduls: \SI{125}{\milli\meter}
    \item
        Abstand zwischen zwei Modulen: \SI{2}{\milli\meter}
    \item
        \"Uberhang      am      oberen      und     unteren      Ende      des
        Moduls: \SI{14}{\milli\meter}
    \item
        Der Abstand zweier Leiterbahnen ist somit \SI{127}{\milli\meter} und
    \item
        die     L\"ange     einer     Leiterbahn     summiert     sich     auf
        \SI{1550}{\milli\meter}.
\end{itemize}


Zur  Berechnung  der  parasit\"aren  Induktivit\"at wird  \emph{The  Self  and
Mutual  Inductances  of Linear  Conductors}  von  Edward B. Rosa  herangezogen
\cite{ref:inductance:rosa}. Darin  wird   unter  anderem   die  Induktivit\"at
einer   Leiterkonfiguration  wie   sie  in   unserem  Modul   angenommen  wird
(Abbildung  \ref{fig:pvmodule:wiring}) bestimmt. Die  zugeh\"orige Formel  ist
in  Gleichung  \ref{eq:rosa:snake}  gegeben\footnotemark.
\footnotetext{%
    Die  Formeln  in   \cite{ref:inductance:rosa}  sind  im  \emph{CKG}-System
    (Centimeter,    Kilogramm,    Sekunden)     notiert,    f\"ur    Gleichung
    \ref{eq:rosa:snake} ist die Gleichung von  Rosa auf das SI-System normiert
    worden.%
}

\noindent Der  Wert f\"ur die Selbstinduktivit\"at  der verschiedenen Dr\"ahte
ist nicht  identisch; dies wird im  Summand $A_{\mathrm{i}}$ ber\"ucksichtigt,
der abh\"angt von der Anzahl  paralleler Leiterbahnen und ihrer Lage innerhalb
der  Leiteranordnung. F\"ur \num{6}  parallele Leiterbahnen  ergeben sich  die
Werte aus Gleichungen \ref{eq:rosa:a1}, \ref{eq:rosa:a2} und \ref{eq:rosa:a3}.


\begin{alignat}{2}
    \label{eq:rosa:snake}
    L &= \frac{\mu_{\mathrm{0}} \cdot l}{2 \cdot \pi}
    \cdot
    \left[
        \ln\left(
            \frac{d}{\rho}
        \right)
        + \frac{1}{4}
        - A_{\mathrm{i}}
    \right] & \quad \text{Selbstinduktivit\"at eines Leiters}
    \\
    \label{eq:rosa:a1}
    A_{\mathrm{1}} &= -\ln\left(\frac{15}{8}\right) & \text{\"ausserste Leiterbahnen} \\
    \label{eq:rosa:a2}
    A_{\mathrm{2}} &= \ln\left(\frac{16}{5}\right)  & \text{Leiterbahnen Nr. 2} \\
    \label{eq:rosa:a3}
    A_{\mathrm{3}} &= \ln\left(\frac{4}{3}\right)   & \text{Leiterbahnen Nr. 3, Mitte}
\end{alignat}

\begin{conditions}
    d              & Abstand zwischen zwei Leiterbahnen \\
    \rho           & Radius des Leiters \\
    A_{\mathrm{i}} & Korrektursummand f\"ur Leiterposition gem\"ass Abbildung \ref{fig:pvmodule:wiring} \\
\end{conditions}

Somit kann f\"ur  jeder Teil der Leitung in einem  Modul dessen Induktivit\"at
berechnet  werden. Diese  werden  anschliessend summiert  (Serieschaltung  von
Induktivit\"aten) und  als Gesamtinduktivit\"at  eines Moduls in  unser Modell
integriert.

Es   wird  von   einem   Leiterquerschnitt  von   \SI{4}{\milli\meter\squared}
ausgegangen,  was  einen   Leiterradius  $\rho$  von  \SI{1.128}{\milli\meter}
ergibt.

Die  Induktivit\"aten der  Leiterbahnen  innerhalb des  Moduls k\"onnen  somit
bestimmt werden:

\begin{alignat}{2}
    L_{\mathrm{1}} &= \frac{\mu_{\mathrm{0}} \cdot l}{2 \cdot \pi}
    \cdot
    \left[
        \ln\left(
            \frac{d}{\rho}
        \right)
        + \frac{1}{4}
        - A_{\mathrm{1}}
    \right]
    & = \SI{1.737}{\micro\henry} \\
    L_{\mathrm{2}} &= \frac{\mu_{\mathrm{0}} \cdot l}{2 \cdot \pi}
    \cdot
    \left[
        \ln\left(
            \frac{d}{\rho}
        \right)
        + \frac{1}{4}
        - A_{\mathrm{2}}
    \right]
    & = \SI{1.181}{\micro\henry} \\
    L_{\mathrm{3}} &= \frac{\mu_{\mathrm{0}} \cdot l}{2 \cdot \pi}
    \cdot
    \left[
        \ln\left(
            \frac{d}{\rho}
        \right)
        + \frac{1}{4}
        - A_{\mathrm{3}}
    \right]
    & = \SI{1.453}{\micro\henry}
\end{alignat}

\begin{conditions}
    \mu_{\mathrm{0}} = 4 \cdot \pi \cdot 10^{-7} & magnetische Permeabilit\"at des Vakuums \\
    l                = \SI{1550}{\milli\meter}   & L\"ange einer Leiterbahn                \\
    d                = \SI{127}{\milli\meter}    & Abstand zweier Leiterbahnen             \\
    \rho             = \SI{1.128}{\milli\meter}  & Radius des Leiters                      \\
    A_{\mathrm{1}}   =  -0.6286                  & Korrektursummand                        \\
    A_{\mathrm{2}}   =   1.1632                  & Korrektursummand                        \\
    A_{\mathrm{3}}   =   0.2877                  & Korrektursummand                        \\
\end{conditions}

Die Gesamtinduktivit\"at der Leiterbahnen in einem Modul ist somit:

\begin{equation}
    \label{eq:pvmodule:totalInductance}
    \underline{\underline{L_{\mathrm{Modul}}
    =
    2 \cdot \left(
        L_{\mathrm{1}} + L_{\mathrm{2}} + L_{\mathrm{3}}
    \right)
    = \SI{8.74}{\micro\henry}}}
\end{equation}

Es bleibt noch der Ohm'sche Widerstand der Leiterbahn zu bestimmen\footnotemark.
Dieser errechnet sich zu:

\footnotetext{%
    Es  sei  an   dieser  Stelle  darauf  hingewiesen,  dass   der  im  Modell
    der  Solarzelle  vorkommende  Seriewiderstand $R_{\mathrm{S}}$  nicht  die
    Leiterbahnen modelliert, sondern thermische Verluste im Halbleitersubstrat
    \cite{pvcell:masmoudi}%
}

\begin{equation}
    \label{eq:resistance:ohm:module}
    \underline{\underline{R = \frac{\rho \cdot l}{A} = \SI{44.2}{\milli\ohm}}}
\end{equation}

\begin{conditions}
    A = \SI{4}{\milli\meter\squared} & Querschnittsfl\"ache des Leiters \\
    \rho = \SI{0.0178}{\ohm\milli\meter\squared\per\meter} & Spezifischer Widerstand Leitungskupfer \cite{ref:kuchling:rhoCu} \\
    l = (6 \cdot 1550 + 5 \cdot 127)\si{\milli\meter} = \SI{9.935}{\meter} & Gesamtl\"ange des Leiters in einem Modul \\
\end{conditions}

Mit  diesen Informationen  kann  das Schaltbild  f\"ur  ein PV-Modul  bestimmt
werden,  was  die  Schaltung  in  Abbildung  \ref{fig:circuit:72x1:simplified}
ergibt. Dieses  Modell  wird im  Folgenden  benutzt,  um eine  Solaranlage  zu
modellieren.

\begin{figure}[h!tb]
    \centering
    \input{images/circuits/module72x1-simplified.tex}
    \caption{%
        Ersatzschaltbild  f\"ur  das  PV-Modul. Es besteht  einem  Strang  mit
        72  Zellen  in Serie  geschaltet  und  angeordnet  wie auf  dem  Modul
        in  Abbildung  \ref{fig:pvmodule}  auf  Seite  \pageref{fig:pvmodule}.
        Zus\"atzlich  ist  die  parasit\"are Induktivit\"at  der  Leiterbahnen
        im  Modul ber\"ucksichtigt  und  eine  Freilaufdiode integriert.   Die
        vollst\"andige  \code{LTspice}-Schaltung  ist  in Abbildung  TODO  auf
        Seite TODO dargestellt.%
    }
    \label{fig:circuit:72x1:simplified}
\end{figure}



% ---------------------------------------------------------------------------- %
\section{Modellierung eines Modulstrangs}
\label{sec:simu:model:module:string}
% ---------------------------------------------------------------------------- %

Der zu  simulierende Modulstrang soll  aus 20  Modulen bestehen, die  in Serie
miteinander  verbunden werden. Die  Induktivit\"at der  Leitungen, welche  die
Module  miteinander verbinden,  wird  vernachl\"assigt,  da die  zugeh\"origen
Distanzen  zwischen den  Leitern viel  gr\"osser sind,  als die  Distanzen der
Leiterbahnen innerhalb eines Moduls (siehe vorheriger Abschnitt).

Es  soll  jedoch  die  Induktivit\"at  der  Anschlussleitung  ber\"ucksichtigt
werden. Dabei   soll  von   einem   \SI{20}{\meter}  langen   Doppelleiterpaar
ausgegangen  werden, das  in einem  Abstand von  \SI{20}{\milli\meter} verlegt
worden ist. Dies ist nat\"urlich eine  idealisierte Annahme; in der Realit\"at
sind  diese Leiter  weder mit  konstant gleichem  Abstand noch  perfekt gerade
verlegt.

Die  von   Rosa  in  \cite{ref:inductance:rosa}  gegebene   Formel  f\"ur  die
Induktivit\"at eines geraden, parallelen Leiterpaares lautet\footnotemark:

\footnotetext{%
    Auch  hier  ist  Rosa's  Formel  auf  das  moderne  SI-System  konvertiert
    worden. Zudem wird  davon ausgegangen,  dass die  Leiter aus  Kupfer sind.
    Dessen  relative  Permeabilit\"at  $\mu_{\mathrm{r}}$  liegt  bei  etwa  1
    \cite{ref:kuchling:muRCu} und kann somit in der Gleichung vernachl\"assigt
    werden.

    Auch Kuchling gibt in \cite{ref:Kuchling:Ltwo} die gleiche Formel.%
}

\begin{equation}
    \label{eq:rosa:dualwire}
    \underline{\underline{L = \frac{\mu_{0}}{\pi} \cdot \left[ \ln\left(\frac{d}{\rho}\right) + \frac{1}{4} \right]
    = \SI{25}{\micro\henry}}}
\end{equation}

\begin{conditions}
    \mu_{\mathrm{0}} = 4 \cdot \pi \cdot 10^{-7} & magnetische Permeabilit\"at des Vakuums \\
    l                = \SI{20}{\meter}           & L\"ange des Leiterpaares (ein Weg)    \\
    d                = \SI{20}{\milli\meter}     & Abstand der Leiter                    \\
    \rho             = \SI{1.128}{\milli\meter}  & Radius des Leiters                    \\
\end{conditions}

Da zwei parallel  verlaufende Leiter im Prinzip  einen Kondensator darstellen,
soll  an  dieser  Stelle  auch   die  parasit\"are  Kapazit\"at  der  zu-  und
wegf\"uhrenden Leiterbahnen ber\"ucksichtigt werden. Die Formel zur Berechnung
dieser Kapazit\"at ist gem\"ass Kuchling \cite{ref:Kuchling:CTwo}:

\begin{equation}
    \label{eq:rosa:dualwire}
    \underline{\underline{C = \frac{\pi \cdot \epsilon_{0} \cdot \epsilon_{\mathrm{r}} \cdot l}{\ln\left(\frac{d}{\rho}\right)}
    = \SI{193.5}{\pico\farad}}}
\end{equation}

\begin{conditions}
    \epsilon_{0} = \SI{8.854}{\pico\farad\per\meter} & Elektrische Feldkonstante          \\
    \epsilon_{\mathrm{r}} = 1                        & Permittivit\"atszahl von Luft      \\
    l                = \SI{20}{\meter}               & L\"ange des Leiterpaares (ein Weg) \\
    d                = \SI{20}{\milli\meter}         & Abstand der Leiter                 \\
    \rho             = \SI{1.128}{\milli\meter}      & Radius des Leiters                 \\
\end{conditions}

Der Ohm'sche Widerstand der Anschlussleitung errechnet sich zu:

\begin{equation}
    \label{eq:resistance:ohm:module}
    \underline{\underline{R = \frac{\rho \cdot l}{A} = \SI{178}{\milli\ohm}}}
\end{equation}

\begin{conditions}
    A    = \SI{4}{\milli\meter\squared} & Querschnittsfl\"ache des Leiters \\
    \rho = \SI{0.0178}{\ohm\milli\meter\squared\per\meter} & Spezifischer Widerstand Leitungskupfer \cite{ref:kuchling:rhoCu} \\
    l    = \SI{40}{\meter} & Gesamtl\"ange der Anschlussleitung (beide Wege) \\
\end{conditions}

\begin{figure}[h!tb]
    \centering
    \input{images/circuits/modulestring.tex}
    \caption{
        Modell  eines   Modulstrangs  aus  20  seriell   geschalteten  Modulen
        mit  Ber\"ucksichtigung  der   Induktivit\"at  und  Kapazit\"at  einer
        \SI{20}{\meter} langen Zuleitung%
    }
    \label{fig:pvstring}
\end{figure}

Abbildung  \ref{fig:pvstring} zeigt  das  Ersatzschaltbild eines  Modulstrangs
aus    20   in    Serie   geschalteten    Modulen   mit    den   parasit\"aren
Leiterimpedanzen. Dieses  und  die  vorangegangenen   Modelle  werden  nun  in
\code{LTspice} implementiert und f\"ur Simulationen benutzt.


% ---------------------------------------------------------------------------- %
\section{Induktive Einkopplung}
\label{sec:simu:coupling:inductive}
% ---------------------------------------------------------------------------- %

Eine induktive Einkopplung legt eine  Spule um die DC-Leitung. Auf diese Spule
wird vom Sensor  das zu \"ubertragende Signal gegeben und  die Spule induziert
in der DC-Leitung entsprechende  Spannungs-Rippel, die vom \Master ausgewertet
werden k\"onnen. Der  entsprechende Schaltkreis  ist schematisch  in Abbildung
\ref{fig:circ:coupling:inductive} dargestellt.

Verglichen mit  Kondensatoren sind Spulen relativ  gross und teuer. Allerdings
ist das Prinzip  der induktiven Einkopplung gut dokumentiert  und die Aussicht
auf Erfolg (bei vern\"unftigem Aufwand) somit gut.

\begin{figure}[h!tb]
    \centering
    \input{images/circuits/coupling-inductive.tex}
    \caption{Induktive Einkopplung}
    \label{fig:circ:coupling:inductive}
\end{figure}

Zur  Modellierung  dieses Vorgangs  ben\"otigt  man  ein Modell  der  Kopplung
zwischen Spule und DC-Leitung.

% ---------------------------------------------------------------------------- %
\clearpage
\section{Kapazitive Einkopplung}
\label{sec:simu:coupling:capacitive}
% ---------------------------------------------------------------------------- %

Bei der kapazitiven Einkopplung wird eine Signalquelle via Kondensator mit der
DC-Leitung  verbunden. Bei  jedem  Modul  und am  Ende  des  Modulstrangs  ist
dabei eine  Einkopplung vorgesehen. Das  Prinzip ist schematisch  in Abbildung
\ref{fig:circ:coupling:capacitive} dargestellt.

Sowohl \Master ~wie auch \Sensor~ k\"onnen dabei Signale senden und empfangen;
das Verfahren ist bidirektional.

\begin{figure}[h!tb]
    \centering
    \input{images/circuits/coupling-capacitive.tex}
    \caption{%
        Vereinfachte Darstellung  der kapazitiven  Einkopplung mit  Sender auf
        der linken  Seite und  Empf\"anger auf der  rechten Seite. Prinzipiell
        ist das Verfahren jedoch bidirektional.%
    }
    \label{fig:circ:coupling:capacitive}
\end{figure}

Zur   Simulation   in  \code{LTspice}   wird   die   Schaltung  in   Abbildung
\ref{fig:ltspice:capacitive:string} benutzt. Sie basiert  auf dem Modell eines
Modulstrangs von Abbildung  \ref{fig:pvstring} (Seite \pageref{fig:pvstring}),
erg\"anzt  um  die  Ein-  und  Auskopplungsschaltung. Zus\"atzlich  wurde  ein
Lastwiderstand von eingebaut.

\begin{figure}[h!tb]
    \centering
    \includegraphics[width=0.95\textwidth]{images/ltspice/jac/inductive.eps}
    \caption{%
        Simulationsschaltung  eines Modulstrangs  mit kapazitiver  Einkopplung
        eines  Signals. Jedes  Modul-Symbol  repr\"asentiert dabei  ein  Modul
        gem\"ass  Abbildung \ref{fig:ltspice:jac:Module}  im Anhang  auf Seite
        \pageref{fig:ltspice:jac:Module}  mit Freilaufdiode  und parasit\"aren
        Leitungsimpedanzen.\protect\\
        In   diesem   Beispiel   sendet   der   \Sensor~   beim   Modul   (die
        Sinus-Spannungsquelle)   und   das   \Master~   empf\"angt   am   Port
        \code{receiver} (rechte Seite).%
    }
    \label{fig:ltspice:capacitive:string}
\end{figure}

\begin{figure}[h!tb]
    \input{images/simu-capacitive/tran.tex}
    \caption{Transientensimulation Kapazitive Einkopplung}
    \label{fig:simu:capacitive:tran}
\end{figure}

% ---------------------------------------------------------------------------- %
\subsection{Sender}
\label{sec:simu:fsk:inductive:transmitter}
% ---------------------------------------------------------------------------- %

% ---------------------------------------------------------------------------- %
\subsection{Empf\"anger}
\label{sec:simu:fsk:inductive:receiver}
% ---------------------------------------------------------------------------- %

% ---------------------------------------------------------------------------- %
\subsection{Gesamtsystem}
\label{sec:simu:fsk:inductive:inductive}
% ---------------------------------------------------------------------------- %


% ---------------------------------------------------------------------------- %
\section{Amplitudenumtastung}
\label{sec:simu:ask}
% ---------------------------------------------------------------------------- %

Wie in Abschnitt \todo{reference} erw\"ahnt, wird bei dieser L\"osungsvariante
jeweils   ein   Modul   gesteuert   kurzgeschlossen. Dies   verursacht   kurze
Spannungseinbr\"uche auf  der DC-Leitung,  welche vom  Empf\"anger ausgewertet
werden k\"onnen, wie in Abbildung \todo{reference}vereinfact dargestellt.

Potentielle Probleme sind bei  dieser L\"osungsvariante in folgenden Bereichen
zu suchen:

\begin{symbols}
    \firmlist
    \item[\textbf{Induktivit\"at der Leitung:}]
        Der  Spannungsabfall   auf  der  DC-Leitung  wird   bei  geschlossenem
        Stromkreis zu Strom\"anderungen auf der DC-Leitung f\"uhren. Dies wird
        eine Spannungs\"anderung auf der DC-Leitung bewirken\footnotemark.
        \footnotetext{%
            Spannung in Abh\"angigkeit der Strom\"anderung:
            $v = L \cdot \frac{\mathrm{d}i}{\mathrm{d}t}$%
        }

        Gem\"ass    Lenz'scher     Regel    \todo{reference}     wird    diese
        Spannungs\"anderung  so gerichtet  sein,  dass  sich der  zugeh\"orige
        Strom der aufgezwungenen \"Anderung widersetzt.

        Es  kann also  sein, dass  die  Induktivit\"at der  DC-Leitung das  zu
        \"ubertragende  Signal  so  stark  kompensiert,  dass  es  nicht  mehr
        detektierbar  ist. Je   h\"oher  die  Frequenz,  mit   der  das  Modul
        kurzgeschlossen  und  wieder  ge\"offnet   wird,  um  so  h\"oher  die
        zugeh\"origen Strom\"anderungen
        $\frac{\mathrm{d}i}{\mathrm{d}{t}}$
        und somit Impedanz der Induktivit\"at (gem\"ass
        $Z_L = j \omega L$).
    \item[\textbf{Kapazit\"at des Solarmoduls:}]
        Dem  Solarmodul   wird  bei   diesem  Vorgehen  das   Verhalten  einer
        Wechselstromquelle   aufgezwungen. Besitzt  es   interne  parasit\"are
        Kapazit\"aten,  k\"onnen  diese  bei  den  abrupten  \"Anderungen  der
        Spannung hohe Str\"ome im  kurzgeschlossenen Pfad und seinen Bauteilen
        verursachen.\footnotemark
        \footnotetext{%
            Strom\"anderung in Abh\"angigkeit der Spannungs\"anderung:
            $I(t) = C \cdot \frac{\mathrm{V(t)}}{\mathrm{d}t}$%
        }

        Besitzen    diese   Bauteile    Ohm'sche   Widerst\"ande,    entstehen
        entsprechende thermische  Verluste, welche die  Bauteile besch\"adigen
        k\"onnen.
\end{symbols}

Die    Tr\"agerfrequenz    in    den    folgenden    Simulationen    betr\"agt
\SI{10}{\kilo\hertz}.


% ---------------------------------------------------------------------------- %
\subsection{Sender}
\label{subsec:simu:ask:sensor}
% ---------------------------------------------------------------------------- %

Das  gesteuerte Kurzschliessen  des Moduls  wird mit  einem MOSFET  umgesetzt,
welcher zwischen  Eingang und  Ausgang des Moduls  durchschalten kann  und vom
Microcontroller auf dem Sensor gesteuert wird. \fref{fig:module:mosfet:simple}
zeigt diesen Aufbau schematisch.

Die  Ansteuerung des  Transistors  erfolgt mit  \SI{3.3}{\volt},  da dies  die
maximale Spannung  ist, welche der  auf dem Sensor  platzierte Microcontroller
ausgeben kann.

\begin{figure}[h!tb]
    \centering
    \input{images/circuits/moduleMOSFET.tex}
    \caption{%
        Gesteuerter     Kurzschluss     eines    Solarmoduls     mit     einem
        microcontroller-gesteuerten       Transistor. Die      vollst\"andigen
        \code{LTspice}-Schaltungen  sind  in Anhang  \ref{app:simu:module}  ab
        Seite \pageref{app:simu:module} dokumentiert.%
    }
    \label{fig:module:mosfet:simple}
\end{figure}

%TODO: line width
\begin{figure}
    \begin{tikzpicture}
       \begin{scope}[x={(0mm,0mm)},y={(120mm,\textwidth)}]
           \begin{axis}[%
                   height=40mm,
                   width=\textwidth,
                   at={(0,70mm)},
                   grid=both,
                   xlabel=Zeit (\si{\micro\second}),
                   ylabel=Strom (\si{\ampere}),
                   %x unit=u,
                   change x base=true,
                   %line width = 1pt,
                   thick,
                   x SI prefix=micro,
               ]
               \addplot[-,color=blue] table {data/module-72cells--I-MOSFET--0005u.dat};
           \end{axis}
           \begin{axis}[%
                   height=40mm,
                   width=\textwidth,
                   at={(0,35mm)},
                   grid=both,
                   xlabel=Zeit (\si{\micro\second}),
                   ylabel=Spannung (\si{\volt}),
                   %x unit=u,
                   change x base=true,
                   x SI prefix=micro,
               ]
               \addplot[-,color=magenta] table {data/module-72cells--U-MOSFET--0005u.dat};
           \end{axis}
           \begin{axis}[%
                   height=40mm,
                   width=\textwidth,
                   at={(0,0)},
                   grid=both,
                   xlabel=Zeit (\si{\micro\second}),
                   ylabel=Leistung (\si{\watt}),
                   %x unit=u,
                   change x base=true,
                   x SI prefix=micro,
               ]
               \addplot[-,color=teal] table {data/module-72cells--P-MOSFET--0005u.dat};
           \end{axis}
       \end{scope}
   \end{tikzpicture}
   \caption{%
       Verlauf    von    Strom,    Spannung    und    Leistung    am    MOSFET
       bei   einer   Schaltfrequenz   von   \SI{10}{\kilo\hertz}   bei   einer
       Modulkonfiguration    von    $36     \times    2$    Zellen    gem\"ass
       Schema    in    \fref{fig:ltspice:module:cellBased:36x2}   auf    Seite
       \ref{fig:ltspice:module:cellBased:36x2}.\protect\\
       Anhang       \ref{app:sec:simu:complementary:36x2}      auf       Seite
       \pageref{app:sec:simu:complementary:36x2} beinhaltet zum Vergleich noch
       Simulationen f\"ur den Zeitraum von einer Millisekunde.%
   }
   \label{fig:simu:results:36x2:3u}
\end{figure}

\begin{figure}
    \begin{tikzpicture}
       \begin{scope}[x={(0mm,0mm)},y={(120mm,\textwidth)}]
           \begin{axis}[%
                   height=40mm,
                   width=\textwidth,
                   at={(0,70mm)},
                   grid=both,
                   xlabel=Zeit (\si{\micro\second}),
                   ylabel=Strom (\si{\ampere}),
                   %x unit=u,
                   change x base=true,
                   x SI prefix=micro,
               ]
               \addplot[-,color=blue] table {data/module-72cells-series--I-MOSFET--0003u.dat};
           \end{axis}
           \begin{axis}[%
                   height=40mm,
                   width=\textwidth,
                   at={(0,35mm)},
                   grid=both,
                   xlabel=Zeit (\si{\micro\second}),
                   ylabel=Spannung (\si{\volt}),
                   %x unit=u,
                   change x base=true,
                   x SI prefix=micro,
               ]
               \addplot[-,color=magenta] table {data/module-72cells-series--U-MOSFET--0003u.dat};
           \end{axis}
           \begin{axis}[%
                   height=40mm,
                   width=\textwidth,
                   at={(0,0)},
                   grid=both,
                   xlabel=Zeit (\si{\micro\second}),
                   ylabel=Leistung (\si{\watt}),
                   %x unit=u,
                   change x base=true,
                   x SI prefix=micro,
               ]
               \addplot[-,color=teal] table {data/module-72cells-series--P-MOSFET--0003u.dat};
           \end{axis}
       \end{scope}
   \end{tikzpicture}
   \caption{%
       Verlauf    von    Strom,    Spannung    und    Leistung    am    MOSFET
       bei   einer   Schaltfrequenz   von   \SI{10}{\kilo\hertz}   bei   einer
       Modulkonfiguration    von    $72     \times    1$    Zellen    gem\"ass
       Schema    in    \fref{fig:ltspice:module:cellBased:36x2}   auf    Seite
       \ref{fig:ltspice:module:cellBased:72x1}. \protect\\
       Anhang     \ref{app:sec:simu:complementary:72x1}     auf     Seite
       \pageref{app:sec:simu:complementary:72x1} beinhaltet zum Vergleich noch
       Simulationen f\"ur den Zeitraum von einer Millisekunde.%
   }
   \label{fig:simu:results:72x1:3u}
\end{figure}

Die    Resultate   der    Simulation   f\"ur    ein   $36    \times   2$-Modul
sind   in   \fref{fig:simu:results:36x2:3u}   f\"ur  einen   Zeitbereich   von
\SI{3}{\micro\second}  dargestellt,  die  Ergebnisse   f\"ur  das  $72  \times
1$-Modul in \fref{fig:simu:results:72x1:3u}.  Tabelle \ref{tab:36x2:72x1:heat}
fasst   die  wichtigsten   Eckdaten  der   Simulationen  zusammen,   inklusive
Durchschnittswerte f\"ur Strom und Leistung.

\begin{table}[h!tb]
    \centering
    \caption{%
        Eckdaten zur Simulation des Kurzschlussverfahrens f\"ur ein Solarpanel
        mit  $36   \times  2$  Zellen  und   ein  Panel  mit  $72   \times  1$
        Zellen.\protect\\
        Bei     den     Durchschnittswerten     sind     sowohl     Ergebnisse
        f\"ur      \SI{1}{\milli\second}     wie      auch     \SI{1}{\second}
        angegeben,    um   zu    zeigen,   dass    sich   die    Konfiguration
        bereits    bei    einer    Millisekunde   stabilisiert    hat    (auch
        zu     sehen    in     Anhang    \ref{app:sec:simu:complementary:36x2}
        auf      Seite      \pageref{app:sec:simu:complementary:36x2}      und
        Anhang      \ref{app:sec:simu:complementary:72x1}       auf      Seite
        \pageref{app:sec:simu:complementary:72x1}).\protect\\
        Die     Dauer      der     Spitze     ist     beim      $36     \times
        2$-Modul     \SI{2}{\micro\second}    und     \SI{1.78}{\micro\second}
        beim    $72    \times    1$-Modul    (siehe    unterste    Plots    in
        den     Abbildungen      \ref{fig:simu:results:36x2:3u}     respektive
        \ref{fig:simu:results:72x1:3u}).%
    }
    \label{tab:36x2:72x1:heat}
    \begin{tabular}{lrr}

    \toprule
    Kriterium                                      & $36 \times 2$-Modul & $72 \times 1$-Modul \\
    \midrule
     Spitzenwert Strom:                            & \SI{32}{\ampere}    & \SI{24}{\ampere}    \\
     Spitzenwert Leistung:                         & \SI{310}{\watt}     & \SI{535}{\watt}     \\
     $\overline{P}$ f\"ur Dauer der Spitze         & \SI{158.77}{\watt}  & \SI{267.46}{\watt}  \\
     $\overline{P}$ f\"ur \SI{1}{\milli\second}    & \SI{4.312}{\watt}   & \SI{6.0577}{\watt}  \\
     $\overline{P}$ f\"ur \SI{1}{\second}          & \SI{4.3047}{\watt}  & \SI{6.0433}{\watt}  \\
    \bottomrule
    \end{tabular}
\end{table}

Aus \fref{fig:simu:results:36x2:5u}  und \tref{tab:36x2:72x1:heat}  ziehen wir
folgende Schlussfolgerungen:

\begin{enumerate}
    \firmlist
    \item
        Der  Spitzenwert f\"ur  den  Strom ist  hoch,  aber Transistoren,  die
        solche Str\"ome  verkraften k\"onnen,  sind zu  vern\"unftigen Preisen
        erh\"altlich.
    \item
        Die    Spitzenwerte    der    Leistungen   zwar    nur    sehr    kurz
        (etwa   \SI{2}{\micro\second}),   aber   sehr  hoch. Auch   wenn   der
        Durchschnittliche Leistungswert  weit unter  der Grenze  von g\"unstig
        erh\"altlichen  MOSFETs   liegt,  k\"onnte  die   Leistungsspitze  den
        Transistor irreversibel sch\"adigen.
    \item
        Der  durchschnittliche  Leistungsverbrauch  ist  weit  \"uber  dem  im
        Pflichtenheft angestrebten Wert von \SI{100}{\milli\watt}.
\end{enumerate}
\todo{korrekte Schlussfolgerungen?}


% ---------------------------------------------------------------------------- %
\clearpage
\subsection{\Master (Empf\"anger)}
\label{subsec:simu:ask:recv}
% ---------------------------------------------------------------------------- %


% ---------------------------------------------------------------------------- %
\subsection{Gesamtsystem}
\label{subsec:simu:ask:total}
% ---------------------------------------------------------------------------- %
